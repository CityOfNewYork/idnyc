<!DOCTYPE html>
<html>
<head>
	<!-- google analytics -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="twitter:card" content="summary_large_image">
	<meta prefix="og: http:/ogp.me/ns#" property="og:title" content="ID NYC Locations Finder">
	<meta prefix="og: http:/ogp.me/ns#" property="og:type" content="website">
	<meta prefix="og: http:/ogp.me/ns#" property="og:url" content="https://maps.nyc.gov/idnyc/">
	<meta prefix="og: http:/ogp.me/ns#" property="og:image" content="https://maps.nyc.gov/idnyc/img/og.png">
	<meta prefix="og: http:/ogp.me/ns#" property="og:image:width" content="1200">
	<meta prefix="og: http:/ogp.me/ns#" property="og:image:height" content="626">
	<meta prefix="og: http:/ogp.me/ns#" property="og:description" content="ID NYC Locations Finder">
	<meta prefix="og: http:/ogp.me/ns#" property="og:site_name" content="maps.nyc.gov">
	<meta name="google-translate-customization" content="4707bd7f535893a0-45bca7b6a97e5a2d-g609df9381571b349-c">

	<title>ID NYC Locations Finder</title>

	<link rel="manifest" href="manifest.webmanifest">
	<link rel="apple-touch-startup-image" href="img/icon-512.png">
	<link rel="apple-touch-icon" sizes="60x60" href="img/icon-60.png">
	<link rel="apple-touch-icon" sizes="76x76" href="img/icon-76.png">
	<link rel="apple-touch-icon" sizes="120x120" href="img/icon-120.png">
	<link rel="apple-touch-icon" sizes="152x152" href="img/icon-152.png">
	<link rel="apple-touch-icon" sizes="167x167" href="img/icon-167.png">
	<link rel="apple-touch-icon" sizes="180x180" href="img/icon-180.png">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.15/proj4.js"></script>
  <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/build/ol.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.4.0/papaparse.min.js"></script>
  <script src="https://maps.nyc.gov/nyc-lib/v1.2.79/js/babel-polyfill.js?%ver%"></script>
	<script src="https://maps.nyc.gov/nyc-lib/v1.2.79/js/nyc-ol-lib.js"></script>
</head>
<body class="loading" aria-hidden="true">
	<div id="map"></div>
	<script>
		
		function Format(options) {
			nyc.ol.format.CsvPoint.call(options);
			this.wkt = new ol.format.WKT();
		};
		Format.prototype = nyc.ol.format.CsvPoint.prototype;
		Format.prototype.readFeature = function(source) {
			var feature = new ol.Feature(source);
			var geom = this.wkt.readFeature('POINT' + source['Location 1']);
			feature.setGeometry(geom.transform('EPSG:4326', 'EPSG:3857'));
		};

		new nyc.ol.FinderApp({
			title: 'ID NYC Locations Finder',
			geoclientUrl: 'https://maps.nyc.gov/geoclient/v1/search.json?app_key=74DF5DB1D7320A9A2&app_id=nyc-lib-example',
			facilityTabTitle: 'Locations',
			facilityUrl: 'https://data.cityofnewyork.us/api/views/5pbr-mxtd/rows.csv?accessType=DOWNLOAD',
			facilityFormat: new Format(),
			facilityStyle: undefined,
			filterChoiceOptions: [{
				name: 'type',
				values: ['permanent'],
				label: '<div class="icon icon-permanent"></div>ID NYC (permanent)',
				checked: true
			}, {
				name: 'type',
				values: ['cultural'],
				label: '<div class="icon icon-cultural"></div>Cultural Institution',
				checked: true
			}, {
				name: 'type',
				values: ['financial'],
				label: '<div class="icon icon-financial"></div>Financial Institution',
				checked: true
			}],
			decorations: [{
				getName: function() {
					return this.get('name');
				},
				getAddress1: function() {
					return this.get('address1');
				},
				getAddress2: function() {
					return this.get('address2');
				},
				getBorough: function() {
					return {
						M: 'Manhattan',
						X: 'Bronx',
						Q: 'Queens',
						K: 'Brooklyn',
						R: 'Staten Island'
					}[this.get('BOROUGH')];
				},
				getCityStateZip: function() {
					return this.getBorough() + ', NY ' + this.get('ZIP');
				},
				getPhone: function() {
					return this.get('PHONE');
				},
				getEmail: function() {
					return this.get('EMAIL');
				},
				getWebsite: function() {
					return this.get('WEBSITE');
				},
				cssClass: function() {
					return this.get('TYPE');
				},
				detailsHtml: function() {
					return $('<div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce lobortis, massa id consequat lacinia, massa enim semper nunc, sit amet dapibus ex mi posuere tellus. Aenean vulputate iaculis lorem elementum finibus. Fusce mauris libero, lacinia sed ultricies nec, imperdiet vel diam.</div>');
				},
			}],
			directionsUrl: 'https://maps.googleapis.com/maps/api/js?client=gme-newyorkcitydepartment&channel=pka&sensor=false&libraries=visualization'
		});		
	</script>
</body>
</html>
